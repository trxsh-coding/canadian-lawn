build_ui_kit:
  stage: build
  image: node:22

  cache:
    key: yarn-cache
    paths:
      - .yarn/cache
      - .yarn/install-state.gz
      - .yarn/build-state.yml
      - node_modules/

  before_script:
    - corepack enable
    - yarn set version 4.9.2
    - yarn install --no-immutable
    - yarn workspaces focus @canadian-lawn/ui-kit @canadian-lawn/api @canadian-lawn/webs

  script:
    - yarn build:ui
    - echo "üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ dist/"
    - ls -la packages/ui-kit/dist || echo "‚ùå dist –∫–∏—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    - yarn build:api
    - ls -la packages/api/dist || echo "‚ùå dist –∞–ø–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    - yarn build:web
    - ls -la packages/web/dist || echo "‚ùå dist –∞–ø–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"


  rules:
    - if: $CI_PIPELINE_SOURCE == "push"
